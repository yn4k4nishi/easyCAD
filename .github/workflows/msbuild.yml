name: MSBuild

on: push

jobs:
  build:
    runs-on: windows-2019
    steps:
      - name: Checkout
        uses: actions/checkout@v2
      - name: Setup
        uses: microsoft/setup-msbuild@v1.0.2
      - name: Vcpkg
        run: |
          vcpkg install tesseract:windows-static
          vcpkg integrate install
      - name: Install wxWidget
        run: |
          wget https://github.com/wxWidgets/wxWidgets/releases/download/v3.1.5/wxWidgets-3.1.5.tar.bz2
          tar xzvf wxWidgets-3.1.5.tar.bz2
          cd wxWidgets-3.1.5
          ./comfigure
          make 
          make install
      - name: CMake & MSBuild
        shell: powershell
        run: |
          mkdir build
          cd build
          cmake ..
          msbuild INSTALL.vcxproj /t:build /p:configuration=Release /p:platform=x64 -maxcpucount
      - name: Upload artifacts
        uses: actions/upload-artifact@v1
        with:
          name: artifacts_win
          path: build_win
